---
title: Pytorch 笔记
toc: true
date: 2022-02-21 10:04:52
categories:
- 深度学习
tags:
- pytorch
- python
---

## `torch.cat()`

在给定维度上对输入的张量序列进行连接操作

* Args
  * tensors (sequence of Tensors): any python sequence of tensors of the same type. 任意`Tensor`类型的python序列，序列中的数据是任意相同`shape`的同类型的`Tensor`
    * Non-empty tensors provided must have the same shape, except in the cat dimension.
  * dim (int, optional): the dimension over which the tensors are concatenated 维度不能超过输入数据任意一个张量的维度
* Keyword args: out (Tensor, optional): the output tensor.

## `torch.gather()`

```python
torch.gather(input, dim, index, *, sparse_grad=False, out=None) -> Tensor
```

沿着由`dim`指定的轴收集数值

* `dim = 0`的情况，代表的是横向，按行取值
  * `length`矩阵中的数的值代表的是行数，所在列代表的是列数

```python
input = [
    [0.0, 0.1, 0.2, 0.3],
    [1.0, 1.1, 1.2, 1.3],
    [2.0, 2.1, 2.2, 2.3]
]#shape [3,4]
input = torch.tensor(input)
length = torch.LongTensor([
    [2,2,2,2],
    [1,1,1,1],
    [0,0,0,0],
    [0,1,2,0]
])#[4,4]
out = torch.gather(input, dim=0, index=length)
```

```plaintext
tensor([[2.0000, 2.1000, 2.2000, 2.3000],
        [1.0000, 1.1000, 1.2000, 1.3000],
        [0.0000, 0.1000, 0.2000, 0.3000],
        [0.0000, 1.1000, 2.2000, 0.3000]])
```

用矩阵的方式演示

$$
\begin{bmatrix}
x_{20} & x_{21} & x_{22} & x_{23} \\\\
x_{10} & x_{11} & x_{12} & x_{13} \\\\
x_{00} & x_{01} & x_{02} & x_{03} \\\\
x_{00} & x_{11} & x_{22} & x_{03} \\\\
\end{bmatrix}
$$

`length`矩阵中的数的值代表的是行数，数的位置代表的列数，比如`length`矩阵中的第三行第三列（从0数起）的数 0，其值是0，代表在`input`中所取的数是第0行，位置是第三列，则表示在`input`中所取的数是第三列，$x_{03} = 0.3$

* `dim = 1`的情况
  * `length`矩阵中的数的值代表的是列数，所在行代表的是行数

```python
input = [
    [0.0, 0.1, 0.2, 0.3],
    [1.0, 1.1, 1.2, 1.3],
    [2.0, 2.1, 2.2, 2.3]
]#shape [3,4]
input = torch.tensor(input)
length = torch.LongTensor([
    [2,2,2,2],
    [1,1,1,1],
    [0,1,2,0]
])#[3,4]
out = torch.gather(input, dim=1, index=length)
```

```plaintext
tensor([[0.2000, 0.2000, 0.2000, 0.2000],
        [1.1000, 1.1000, 1.1000, 1.1000],
        [2.0000, 2.1000, 2.2000, 2.0000]])
```

对应的取值矩阵是

$$
\begin{bmatrix}
x_{02} & x_{02} & x_{02} & x_{02} \\\\
x_{11} & x_{11} & x_{11} & x_{11} \\\\
x_{20} & x_{21} & x_{22} & x_{20} \\\\
\end{bmatrix}
$$